"use strict";angular.module("comedyApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).service("comedyService",["$http",function(e){var o=[],n=[],i=[],l=0,r="inferno",t=localStorage.getItem("comedyOpt");null!=t&&(r=t);var a=localStorage.getItem("comedyRawlines");null!=a&&(n=a);var s=localStorage.getItem("comedyLines");null!=s&&""!=s&&(o=s);function c(t){var e="<br>";if(0<t.trim().length){if(/^##/.test(t))return 0<i.length&&(o.push({name:name,line:l,text:i.join(e),visible:!0}),i=[]),name=t.replace(/^## /,""),void(l=0);var n=t.replace(/--/g,"&#x2012;");i.push(n.trim()),l++,3==i.length&&(o.push({name:name,line:l-2,text:i.join(e),visible:!0}),i=[])}}function u(){o=[];for(var t=0;t<n.length;t++)c(n[t]);0<o.length&&o.push({line:l-1,text:n.join("<br>")}),localStorage.setItem("comedyLines",JSON.stringify(o))}return{opt:function(t){return r!=t&&(r=t),r},lines:function(t){return o!=t&&(o=t),o},makelines:function(){u()},feedme:function(){var t="https://dsmarkchen.github.io/comedy/data/"+r+".txt";e.get(t).then(function(t){n=t.data.split(/\r?\n/),localStorage.setItem("comedyRawlines",JSON.stringify(n)),u()})},rawlines:function(t){return n!=t&&(n=t),n},feed:function(t){feedme(t)}}}]).directive("xwindow",["$window",function(i){return{link:function(t,e,n){function o(){console.log(i.innerWidth),t.width!==i.innerWidth&&(t.width=i.innerWidth,t.$digest()),t.height!==i.innerHeight&&(t.height=i.innerHeight,t.$digest())}t.width=i.innerWidth,t.height=i.innerHeight,angular.element(i).on("resize",o),t.$on("$destroy",function(){angular.element(i).off("resize",o)})},restrict:"A"}}]).directive("countUp",["$compile",function(i,t){return{restrict:"E",replace:!1,scope:{countTo:"=countTo",start:"=start",step:"=step",interval:"=interval"},controller:["$scope","$element","$attrs","$timeout",function(e,t,n,o){e.millis=e.start,0===t.html().trim().length?t.append(i("<span>{{millis}}</span>")(e)):t.append(i(t.contents())(e));!function t(){o(function(){e.millis+=e.step,e.$digest(),e.millis<e.countTo&&t()},e.interval)}()}]}}]).directive("tooltip",["$compile","$sce",function(i,l){return{restrict:"A",scope:{content:"=tooltipContent"},link:function(e,t,n){e.displayTooltip=!1,e.updateTooltipOpacity=function(t){o.css({opacity:t,"max-width":340})},e.updateTooltipPosition=function(t,e){$(this);o.css({top:t+"px",left:e+"px"})},e.getSafeContent=function(t){return l.trustAsHtml(t)};var o=angular.element('<div ng-show="displayTooltip" id="tooltip">        \t<span ng-bind-html="getSafeContent(content)"></span>        </div>');angular.element('<div ng-show="displayTooltip" class="tooltip">        \t<span ng-bind-html="getSafeContent(content)"></span>        </div>');angular.element(document.querySelector("body")).append(o),t.on("mouseenter",function(t){e.displayTooltip=!0,e.$digest()}),t.on("mousemove",function(t){e.updateTooltipOpacity(.9),e.updateTooltipPosition(t.clientY-20,t.clientX+5)}),t.on("mouseleave",function(){e.displayTooltip=!1,e.$digest()}),i(o)(e)}}}]).directive("xtooltip",function(){return{restrict:"A",link:function(t,e,n){e.hover(function(){e.tooltip({html:"true",container:"body"}),e.tooltip("show")},function(){e.tooltip("hide")})}}}).directive("bs-tooltip",function(){return function(t,e,n){n.$observe("title",function(t){e.tooltip("destroy"),jQuery.trim(t)&&e.tooltip()}),e.on("$destroy",function(){e.tooltip("destroy"),delete n.$$observers.title})}}).directive("owlCarousel",function(){return{restrict:"E",transclude:!1,link:function(i){i.initCarousel=function(t){var e={},n=i.$eval($(t).attr("data-options"));for(var o in n)e[o]=n[o];$(t).owlCarousel(e)}}}}).directive("owlCarouselItem",function(){return{restrict:"A",transclude:!1,link:function(t,e){t.$last&&t.initCarousel(e.parent())}}}).config(["$routeProvider",function(t,e){t.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/comedy/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/main",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/comedy/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/comedy/voyage",{templateUrl:"views/voyage.html",controller:"VoyageCtrl",controllerAs:"voyage"}).when("/voyage",{templateUrl:"views/voyage.html",controller:"VoyageCtrl",controllerAs:"voyage"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/canto",{templateUrl:"views/canto.html",controller:"CantoCtrl",controllerAs:"canto"}).otherwise({redirectTo:"/"})}]),angular.module("comedyApp").filter("split",function(){return function(t){var e=t.split(/([!,.;?-])/g),n="",o="",i="";return e.forEach(function(t){if(n+=t,52<t.length){return n.split(/(that|where|which|when|who)/g).forEach(l),o+=i,void(n="")}((o+=t).endsWith("--")&&"-"==t||"?"==t||";"==t||"."==t||"!"==t||","==t)&&(o+="\n",n="")}),console.log("line_index:0"),o;function l(t){if("that"==t||"where"==t||"when"==t||"who"==t||"which"==t)return i+="\n ",void(i+=t);i+=t}}}).controller("MainCtrl",["$window","$scope","$location",function(t,e,n){var o,i;this.test="testing mainController",e.txTotalSymbols=localStorage.getItem("totalSymbols"),e.txTotalLHs=localStorage.getItem("totalLHs"),e.rxTotalSymbols=localStorage.getItem("rxTotalSymbols"),e.rxTotalLHs=localStorage.getItem("rxTotalLHs"),e.isActive=function(t){return t===n.path()},e.ie=(o=window.navigator.userAgent,0<(i=o.indexOf("MSIE"))?parseInt(o.substring(i+5,o.indexOf(".",i))):navigator.userAgent.match(/Trident\/7\./)?11:0)}]),angular.module("comedyApp").controller("CantoCtrl",["$scope","$http","comedyService","fileReader",function(a,t,e,n){a.lines=[],a.myQuery="1:1,25",a.opt=localStorage.getItem("comedyOpt"),null==a.opt&&(a.opt="inferno",localStorage.setItem("comedyOpt",a.opt)),e.opt(a.opt);var o=JSON.parse(localStorage.getItem("comedyLines"));null!=o?a.lines=o:e.feedme().then(function(t){a.lines=e.lines});a.items2=[{name:"Inferno",text:"the misery of the spirit bound to the prides and actions of the flash"},{name:"Purgatorio",text:"the process of transmuting fleshly into spiritual experience"},{name:"Paradiso",text:"the degrees of spiritual realization"}];var s=3;a.move=function(){var t=a.myQuery;if(""!=t){var e=t.split(/[,:]/),n=e[0].trim(),o=parseInt(e[1].trim(),10),i=parseInt(e[2].trim(),10),l=i-o;if(0<s){i=i+l+1;var r=(o=o+l+1)%3;0==r&&(o+=1,i+=1),2==r&&(o-=1,i-=1)}s<0&&(o=o-l-1,i=i-l-1,0==r&&(o+=1,i+=1),2==r&&(o-=1,i-=1)),o<0&&(o=1),a.myQuery=n+":"+o.toString()+","+i.toString(),localStorage.setItem("myQuery",a.myQuery)}},a.prev=function(){s=-3,a.move()},a.next=function(){s=3,a.move()},a.change=function(){localStorage.setItem("myCantoOpt",a.opt)},a.getComedylines=function(){return e.lines},a.$watch("comedyService.rawlines",function(t,e){e!=t&&(a.rawlines=t,localStorage.setItem("myRawlines",a.rawlines))}),a.$watch("comedyService.lines",function(t,e){e!=t&&(a.lines=t)}),a.$watch("comedyService.opt",function(t,e){e!=t&&(a.opt=t)})}]).filter("myCantoFilter",function(){return function(t,e){var n=[];if(""==e)return t;var o=e.split(/[,:]/),i=o[0],l=o[1],r=o[2];return angular.forEach(t,function(t){null!=t.name&&t.name.trim()==i.trim()&&t.line>=l&&t.line<r&&n.push(t)}),n}}),angular.module("comedyApp").controller("VoyageCtrl",["$scope",function(e){e.selectedIndex=-1,e.current=0,e.setCurrent=function(t){e.current=t},e.selectedItem=[],e.items2=[{name:"Francesca",text:"Love, that releases no beloved from loving took hold of me so strongly through his beauty that, as you see, it has not left me yet."},{name:"Purgatorio",text:"the process of transmuting fleshly into spiritual experience"},{name:"Picarda",text:"And in His will there is our peace: that sea to which all beings move—the beings He creates or nature makes—such is His will."}],e.users=["joseph","james","joseph 22 ","joseph"],e.comments=["comment 1","comment2","",""],e.selectItem=function(t){e.selectedItem=e.items2[t],e.selectedIndex=t}}]),angular.module("comedyApp").controller("AboutCtrl",["$scope","comedyService","fileReader",function(r,e,t){r.items2=[{name:"Inferno",text:"the misery of the spirit bound to the prides and actions of the flash"},{name:"Purgatorio",text:"the process of transmuting fleshly into spiritual experience"},{name:"Paradiso",text:"the degrees of spiritual realization"}],r.users=["joseph","james","joseph 22 ","joseph"],r.comments=["comment 1","comment2","",""],r.isNullOrEmpty=function(t){return null==t||""===t},r.calcCP=function(){var t=r.name,e=r.attack,n=r.defense,o=r.hp,i=(ivService.getStat(t),parseInt(r.level)),l={Atk:parseInt(e),Def:parseInt(n),Hp:parseInt(o)};r.cp=ivService.calculateCP(i,l,{Atk:112,Def:152,Hp:225})},r.getFile=function(){t.readAsText(r.file,r).then(function(t){r.raw=t.split(/\r?\n/),localStorage.setItem("comedyRawlines",JSON.stringify(r.raw)),e.rawlines(r.raw),e.makelines(),console.log("getRaw "+r.raw)})},r.reset=function(){e.rawlines([]),e.feedme(),e.makelines()},r.$on("fileProgress",function(t,e){r.progress=e.loaded/e.total}),r.$watch("comedyService.lines",function(t,e){e!=t&&(r.lines=t)}),r.$watch("comedyService.opt",function(t,e){e!=t&&(r.opt=t)})}]).directive("ngFileSelect",function(){return{link:function(e,t){t.bind("change",function(t){e.file=(t.srcElement||t.target).files[0],e.getFile()})}}}).factory("fileReader",["$q","$log",function(o,t){t.log("fileReader");return{readAsText:function(t,e){var n=o.defer();return function(t,e){var n=new FileReader;return n.onload=function(t,e,n){return function(){n.$apply(function(){e.resolve(t.result)})}}(n,t,e),n.onerror=function(t,e,n){return function(){n.$apply(function(){e.reject(t.result)})}}(n,t,e),n.onprogress=function(t,e){return function(t){e.$broadcast("fileProgress",{total:t.total,loaded:t.loaded})}}(0,e),n}(n,e).readAsText(t),n.promise}}}]),angular.module("comedyApp").run(["$templateCache",function(t){t.put("views/about.html",' <section id="about"> <div class="container"> <div class="row"> <div class="col-md-6"> <div class="block"> <ul class="counter-box clearfix"> <li> <div class="block"> <i class="ion-ios-chatboxes-outline"></i> <h4 class="counter"><count-up start="0" step="5" count-to="70" interval="1"></count-up></h4> <span>Life Span</span> </div> </li> <ul class="counter-box clearfix"> <li> <div class="block"> <i class="ion-ios-glasses-outline"></i> <h4 class="counter"><count-up start="0" step="1" count-to="3" interval="1000"></count-up></h4> <span>Root to source</span> </div> </li> <ul class="counter-box clearfix"> <li> <div class="block"> <i class="ion-ios-compose-outline"></i> <h4 class="counter"><count-up count-to="1321" step="1" start="1265" step="10" interval="1"></count-up></h4> <span>Death</span> </div> </li> <ul class="counter-box clearfix"> <li> <div class="block"> <i class="ion-ios-timer-outline"></i> <h4 class="counter"><count-up count-to="1265" step="5" start="1200" interval="1"></count-up></h4> <span>Born</span> </div> </li> </ul> </ul> </ul> </ul> </div> </div> <div class="col-md-6"> <data-owl-carousel class="about-carousel owl-carousel" data-options="{navigation: false, pagination: true, singleItem: true, rewindNav : false}"> <div owl-carousel-item="" ng-repeat="item in ::items2 track by $index" class="owl-item"> <div> <div class="user"> <img src="images/item-img2.1626849d.jpg" alt="People"> <h2>{{item.name}}</h2> </div> <p>{{item.text}}</p> </div> </div> </data-owl-carousel> </div> </div> <div class="row"> <h2>Settings</h2> </div> <div class="row"> <div class="col-md-6"> <form> <b>Import Your Canto:</b> <input type="file" ng-file-select="onFileSelect($files)" class="form-control-file border"> </form> </div> <div class="col-md-6"> <form> <b>Reset:</b><br> <button class="btn btn-secondary" ng-click="reset()">default</button> </form> </div> </div> </div> </section> '),t.put("views/canto.html",'<section id="canto"> <div class="container"> <div class="row"> <div class="col-md-3"> <div class="form-check form-check-inline"> <input class="form-check-input" type="radio" ng-model="opt" value="inferno" ng-change="change()"> <label class="form-check-label">inferno</label> </div> <div class="form-check form-check-inline"> <input class="form-check-input" type="radio" ng-model="opt" value="purgatorio" ng-change="change()"> <label class="form-check-label">purgatorio</label> </div> <div class="form-check form-check-inline"> <input class="form-check-input" type="radio" ng-model="opt" value="paradiso" ng-change="change()"> <label class="form-check-label">paradiso</label> </div> </div> <div class="canto-outline col-md-6"> <div class="" ng-repeat="canto in lines | myCantoFilter: myQuery  track by $index "> <div class="row" ng-if="canto.visible"> <div class="col-1" style="margin:0px 0px 0px 0px;padding:0px 0px; border: 1px solid #f8f9fa;"> <p class="line" style="margin:0px 0px 0px 0px;padding:0px 0px;background-color:#f8f9fa;">{{canto.name}}:{{canto.line}} </p> </div> <div class="col-11" style="padding-left:1px;padding-right:1px"> <p class="canto" ng-bind-html="canto.text"></p> </div> </div> </div> </div> <div class="col-md-3"> <form> <div class="form-group row"> <div class="input-group-addon col-sm-1"><i class="fa fa-search"></i></div> <input type="text" class="form-control col-sm-9 offset-sm-1" placeholder="query: start, end" ng-model="myQuery"> </div> </form> <div class="row"> <button class="btn btn-secondary col-sm-3 offset-sm-1" ng-click="prev()"><i class="ion-ios-arrow-left"></i> </button> <button class="btn btn-secondary col-sm-3 offset-sm-1" ng-click="next()"><i class="ion-ios-arrow-right"></i></button> </div> </div> </div> </div> </section> '),t.put("views/main.html",'<div class="jumbotron jumbotron-fluid"> <div class="container"> <div class="block"> <h1 class="animated fadeInUp">Divine Comedy</h1> <p class="animated fadeInUp">Inferno, Purgatorio, Paradiso</p> <div ng-hide="ie == 0"> <p class="animated fadeInUp">IE {{ie}}</p> </div> </div> </div> </div> <div class="container"> <p> <strong> Summary </strong> </p> <table class="table table-striped"> <tr> <th> </th> <th> Tx</th> <th> Rx</th> <th> Percentage</th> </tr> <tr> <td> symbols </td> <td>{{txTotalSymbols}} </td> <td>{{rxTotalSymbols}} </td> <td>{{rxTotalSymbols /txTotalSymbols * 100 | number : 2}} </td> </tr> <tr><td> sequences </td> <td> {{txTotalLHs}} </td> <td> {{rxTotalLHs}} </td> <td> {{rxTotalLHs/txTotalLHs * 100 | number : 2}} </td> </tr> </table> <div xwindow> <p ng-if="width > 320">The device window is: [{{width}}, {{height}}].</p> </div> </div> '),t.put("views/voyage.html",' <section id="voyage"> <div class="container"> <div class="row"> <div class="col-md-12"> <div class="block"> <div class="voyage-menu"> <ul> <li ng-repeat="item in items2 track by $index " ng-click="setCurrent($index)">{{item.name}}</li> </ul> </div> <div class="voyage-content"> {{items2[current].text}} </div> </div> </div> </div> </div> </section> ')}]);